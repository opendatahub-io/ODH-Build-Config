pull_request_rules:
  - name: Add to queue when ready
    conditions:
      - -author~=^(rhods-ci-bot|red-hat-konflux\[bot\]|odh-devops-app\[bot\])$
      - check-success=^ci\/prow.*
      - check-success~=^"Red Hat Konflux".*
      - "#approved-reviews-by>=1"
      - -draft
      - base~=(stable|main)
    actions:
      queue:
        name: default
  - name: Auto rebase
    conditions:
      - base~=(stable|main)
      - -conflict
    actions:
      rebase: {}
  - name: Close stale PR
    conditions:
      - status-success=build
      - -closed
      - updated-at < 30 days 0 hours 0 minutes ago
    actions:
      close:
        message: "Closing stale PR"
  - name: Bypass
    conditions:
      - author~=^(rhods-ci-bot|red-hat-konflux\[bot\]|odh-devops-app\[bot\])$
    actions:
      merge:
        method: squash
queue_rules:
  - name: default
    conditions:
      - -author~=^(release-bot|ops-user)$
      - check-success=^ci\/prow.*
      - check-success~=^"Red Hat Konflux".*
      - "#approved-reviews-by>=1"
      - -draft
      - base~=(stable|main)