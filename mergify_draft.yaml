pull_request_rules:

  ###########################################################
  # 1️⃣ Bot Bypass Rule (must be first – higher priority)
  ###########################################################
  - name: Bot direct merge bypass
    conditions:
      - base~=^(main|release/.*)$
      - author~=^(dependabot\[bot\]|renovate-bot|my-custom-bot)$
      - check-success~=^(build|test|lint)$
    actions:
      merge:
        method: merge


  ###########################################################
  # 2️⃣ Normal PRs → Add to Merge Queue
  ###########################################################
  - name: Add PR to merge queue when ready
    conditions:
      - base~=^(main|release/.*)$
      - -draft
      - check-success~=^(build|test|lint)$
      - "#approved-reviews-by>=1"
      - "#comment~=^/lgtm"
    actions:
      queue:
        name: protected-queue
        delay: 60 seconds


###########################################################
# 3️⃣ Merge Queue Configuration
###########################################################
queue_rules:
  - name: protected-queue
    delay: 60 seconds
    conditions:
      - base~=^(main|release/.*)$
      - check-success~=^(build|test|lint)$
      - "#approved-reviews-by>=1"
      - "#comment~=^/lgtm"